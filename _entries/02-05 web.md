---
sectionid: ratingsweb
sectionclass: h2
title: フロントアプリのデプロイ
parent-id: lab-ratingapp
---

`rating-web` は `rating-api`に接続するNodeJSアプリケーションです。これを展開するために必要となる情報は以下の通りです。

- GitHub: <https://github.com/microsoft/rating-web>
- コンテナは8080ポートを使用します
- Webアプリケーションは、内部クラスタDNSを介してAPIという名前の環境変数を介してプロキシを使用して接続します。 

### OpenShift CLI を使って `rating-web` をデプロイする

> **Note** You're going to be using [source-to-image (S2I)](#source-to-image-s2i) as a build strategy.

{% collapsible %}

```sh
./oc new-app https://github.com/microsoft/rating-web
```

![Create rating-web using oc cli](media/oc-newapp-ratingweb.png)

{% endcollapsible %}

### 必要な環境変数を設定します

{% collapsible %}

環境変数`API` を作成します。この変数の値は、`rating-api` サービスのホスト名/ポートになります。通常、次のようになります。

http://rating-api.workshop.svc.cluster.local:8080

完了したら[Save]をクリックします。

![Create an API environment variable](media/rating-web-envvars.png)

{% endcollapsible %}

### `rating-web` Routeを使ってサービスを公開する

{% collapsible %}

サービスを公開します。

```sh
./oc expose svc/rating-web
```

作成したホスト名を確認します。

```sh
./oc get route rating-web
```

以下のようなレスポンスが得られます。

![Retrieve the created route](media/oc-get-route.png)

FQDNはデフォルトではアプリケーション名とプロジェクト名で構成されています。FQDNの残りの部分、つまりサブドメインはAzure Red Hat OpenShiftクラスター固有のアプリのサブドメインです。

{% endcollapsible %}

### サービスを確認します

{% collapsible %}

ブラウザでホスト名を開くと、サンプルのアプリが表示されます。投票して結果をチェックしてください。

![rating-web homepage](media/rating-web-homepage.png)

{% endcollapsible %}

> **Resources**
> * <https://docs.openshift.com/aro/creating_images/s2i.html>
> * <https://docs.openshift.com/aro/dev_guide/routes.html>